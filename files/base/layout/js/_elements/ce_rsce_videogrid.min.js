(()=>{"use strict";document.addEventListener("DOMContentLoaded",(function(){const e=new Map,t=new WeakSet;async function a(t){if(!t||"true"===t.dataset.videoLoaded)return;const a=t.querySelector(".lazy-video-container");if(!a)return;const o=a.dataset.videoParams;if(o)try{if(e.has(o))return a.innerHTML=e.get(o),t.dataset.videoLoaded="true",void r(a);const n=await fetch("/video/render",{method:"POST",headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"},body:o});if(!n.ok)throw new Error(`HTTP error! status: ${n.status}`);const s=await n.text();s&&(e.set(o,s),a.innerHTML=s,t.dataset.videoLoaded="true",r(a))}catch(e){console.error("Fehler beim Laden des Videos:",e),t.dataset.videoLoaded="false"}}function r(e){const t=e.querySelector("video");if(!t)return;t.dataset.src&&(t.src=t.dataset.src,t.removeAttribute("data-src"));t.querySelectorAll("source[data-src]").forEach((e=>{e.src=e.dataset.src,e.removeAttribute("data-src")})),t.dataset.poster&&(t.poster=t.dataset.poster),t.load(),t.autoplay&&t.play().catch((e=>{console.warn("AutoPlay fehlgeschlagen, versuche mit muted:",e),t.muted=!0,t.play().catch((e=>console.warn("Auch muted AutoPlay fehlgeschlagen:",e)))})),window.VSM&&window.VSM.lazyMediaLoader&&(t.classList.add("lazy-handled","loaded"),document.dispatchEvent(new CustomEvent("vsm:videoLoaded",{detail:{videoElement:t}})))}function o(e){e&&"true"!==e.dataset.initialized&&(window.matchMedia("(min-width: 768px)").matches?(e.querySelectorAll(".video-column").forEach(((e,r)=>{const o=e.querySelector(".scroll-content");if(!o)return;const n=e.offsetHeight,s=Array.from(o.querySelectorAll(".video-item")),d=s[0].offsetHeight,i=Math.ceil(n/d)+2;for(;s.length<i;){const e=s.slice(0,Math.min(s.length,i-s.length)).map((e=>{const t=e.cloneNode(!0);return o.appendChild(t),t}));s.push(...e)}o.querySelectorAll(".video-preview").forEach((e=>{t.has(e)||(a(e),t.add(e))}));let c=0;const l=r%2==0?1:-1;let u=!1,h=null;s.forEach(((e,t)=>{e.style.position="absolute",e.style.top="0",e.style.left="0",e.style.width="100%",e.style.transform=`translateY(${t*d}px)`})),e.addEventListener("mouseenter",(()=>{u=!0})),e.addEventListener("mouseleave",(()=>{u=!1})),function(e){window.matchMedia("(min-width: 1024px)").matches&&e.querySelectorAll(".video-item").forEach((e=>{e.addEventListener("mousemove",(t=>{const a=e.getBoundingClientRect(),r=t.clientX-a.left,o=(t.clientY-a.top-a.height/2)/10,n=(a.width/2-r)/10,s=e.style.transform?.match(/translateY\(([^)]+)\)/)?.[1]||"0px";e.style.transform=`translateY(${s}) perspective(800px) rotateX(${o}deg) rotateY(${n}deg) scale(1.0) translateZ(20px)`})),e.addEventListener("mouseleave",(()=>{const t=e.style.transform?.match(/translateY\(([^)]+)\)/)?.[1]||"0px";e.style.transform=`translateY(${t})`}))}))}(e),function e(){u||(c+=.2*l,s.forEach((e=>{let t=parseFloat(e.style.transform?.match(/translateY\(([^)]+)\)/)?.[1]||0);t-=.2*l,l>0?t<-d&&(t=n):t>n&&(t=-d);const a=e.style.transform?.match(/(perspective.*$)/)||[""];e.style.transform=`translateY(${t}px) ${a[0]}`}))),h=requestAnimationFrame(e)}(),e.cleanup=()=>{h&&cancelAnimationFrame(h)}})),e.dataset.initialized="true"):e.querySelectorAll(".video-preview").forEach((e=>{t.has(e)||(a(e),t.add(e))})))}const n=new IntersectionObserver((e=>{e.forEach((e=>{e.isIntersecting&&o(e.target)}))}),{rootMargin:"50px",threshold:.1});document.querySelectorAll(".ce_rsce_videogrid").forEach((e=>{n.observe(e)})),document.addEventListener("visibilitychange",(()=>{document.hidden&&e.clear()}))}))})();