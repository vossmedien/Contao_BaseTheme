(()=>{"use strict";document.addEventListener("DOMContentLoaded",(function(){function e(e,t,s,i){const o=`__${t}_handler__`;e[o]&&e.removeEventListener(t,e[o],i),e.addEventListener(t,s,i),e[o]=s}function t(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:document.documentElement;if("string"!=typeof e)return parseFloat(e)||0;const s=parseFloat(e);return isNaN(s)?0:e.endsWith("px")?s:e.endsWith("rem")?s*parseFloat(getComputedStyle(document.documentElement).fontSize):e.endsWith("em")?s*parseFloat(getComputedStyle(t).fontSize):e.endsWith("vh")?s*window.innerHeight/100:e.endsWith("vw")?s*window.innerWidth/100:s}class s{constructor(e){this.element=e,this.isExpanded=!1,this.isActive=!1,this.isInteracting=!1}expand(){this.isExpanded||(this.isExpanded=!0,this.element.classList.add("is-expanded"),function(e){const t=e.querySelector(".stoerer--content");if(!t)return;const s=t.style.transition;t.style.transition="none",t.style.maxWidth="max-content";const i=t.scrollWidth;t.style.maxWidth="",t.style.transition=s,requestAnimationFrame((()=>{t.style.setProperty("--stoerer-content-max-width",i+"px")}))}(this.element))}collapse(){if(this.isExpanded){this.isExpanded=!1,this.element.classList.remove("is-expanded"),function(e){const t=e.querySelector(".stoerer--content");t&&t.style.removeProperty("--stoerer-content-max-width")}(this.element);this.element.querySelectorAll("a, button, input, textarea, select, [tabindex]").forEach((e=>e.blur())),this.element.classList.add("force-collapsed"),setTimeout((()=>{this.element.classList.remove("force-collapsed")}),100)}}activate(){this.isActive=!0,this.element.classList.add("is-active")}deactivate(){this.isActive=!1,this.element.classList.remove("is-active")}setInteracting(e){this.isInteracting=e,this.element.classList.toggle("is-interacting",e)}}const i=new Map;function o(e){return i.has(e)||i.set(e,new s(e)),i.get(e)}function n(){return"ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0||window.innerWidth<768}function r(e,t){const s=o(t);return!!n()&&(s.isActive||s.isExpanded?(s.deactivate(),s.collapse(),!0):(e.preventDefault(),i.forEach((e=>{e.deactivate(),e.collapse()})),s.activate(),s.expand(),!0))}function a(){document.querySelectorAll(".is-fixed.content--element.ce_rsce_stoerer").forEach((e=>{const s=Array.from(e.querySelectorAll(":scope > .ce--stoerer.is-expandable"));if(s.length<=1)return void s.forEach((e=>{e.style.zIndex="",e.dataset.originalStyleTop&&e.dataset.originalStyleTop!==e.style.top&&(e.style.top=e.dataset.originalStyleTop)}));const i=getComputedStyle(e).getPropertyValue("--stoerer-vertical-gap")||"0.75rem",o=Math.max(t(i.trim(),e),8);s.sort(((e,s)=>{const i=e.classList.contains("article-info-nav-stoerer")||"stoerer-130-1"===e.id,o=s.classList.contains("article-info-nav-stoerer")||"stoerer-130-1"===s.id;if(i&&!o)return 1;if(!i&&o)return-1;if(i&&o)return 0;const n=e=>{if(!e.dataset.initialTopPx){let s=e.style.top,i=getComputedStyle(e).getPropertyValue("--stoerer-page-top").trim();if(window.innerWidth<768){const t=getComputedStyle(e).getPropertyValue("--stoerer-top-mobile").trim();t&&""!==t&&(i=t)}if(i&&""!==i)s=i,console.log("Verwende CSS Custom Property für Störer:",e.id,"Wert:",i);else if(!s||"auto"===s||""===s||"0px"===s){const t=getComputedStyle(e).top;s=t&&"auto"!==t&&t.includes("px")&&parseInt(t)<5e3?t:"0px"}e.dataset.originalStyleTop=s,e.dataset.initialTopPx=t(s,e),console.log("getTopValue für",e.id,"styleTop:",s,"initialTopPx:",e.dataset.initialTopPx),parseInt(e.dataset.initialTopPx)>5e3&&console.warn("Störer mit sehr hohem top-Wert gefunden:",e,"initialTopPx:",e.dataset.initialTopPx,"originalStyleTop:",s)}return parseFloat(e.dataset.initialTopPx)};return n(e)-n(s)}));let n="0px",r=0;s.forEach(((e,t)=>{if(e.style.zIndex=s.length-t,0===t){let t=getComputedStyle(e).getPropertyValue("--stoerer-page-top").trim();if(window.innerWidth<768){const s=getComputedStyle(e).getPropertyValue("--stoerer-top-mobile").trim();s&&""!==s&&(t=s)}t&&""!==t?(n=t,e.style.top&&"0px"!==e.style.top&&"auto"!==e.style.top||(e.style.top=n)):e.style.top&&"0px"!==e.style.top&&"auto"!==e.style.top?n=e.style.top:e.dataset.originalStyleTop&&(n=e.dataset.originalStyleTop),console.log("Erster Störer behält Position:",e.id,"Position:",e.style.top),console.log("firstStoererOriginalTop gesetzt auf:",n);const s=e.querySelector(".stoerer-trigger");r=s?s.offsetHeight:0}else{if(console.log("Trigger-Höhe für ersten Störer:",r,"Gap:",o),1===t){const t=r+o;e.style.top=`calc(${n} + ${t}px)`}else{let i=r;for(let e=1;e<t;e++){const t=s[e].querySelector(".stoerer-trigger");i+=(t?t.offsetHeight:40)+o}const a=i+o;e.style.top=`calc(${n} + ${a}px)`}console.log("Störer positioniert:",e.id,"Position:",e.style.top,"Index:",t,"basierend auf firstStoererOriginalTop:",n)}}))}))}function l(){document.querySelectorAll('.ce--stoerer[style*="left:"], .ce--stoerer[style*="right:"]').forEach((e=>{e.classList.remove("is-flush-left","is-flush-right");const t=e.getBoundingClientRect();t.left<=2?e.classList.add("is-flush-left"):t.right>=window.innerWidth-2&&e.classList.add("is-flush-right")}))}function c(){const t=document.querySelectorAll(".ce--stoerer.is-expandable"),s=document.querySelectorAll(".content--element.ce_rsce_stoerer");t.forEach((t=>{const s=o(t),i=t.querySelector(".stoerer-trigger");i&&!i.dataset.listenerAttached&&(e(i,"click",(e=>{r(e,t)||(s.setInteracting(!0),s.isActive||s.isExpanded?(s.collapse(),s.deactivate()):(s.expand(),s.activate()),setTimeout((()=>s.setInteracting(!1)),50))})),i.dataset.listenerAttached="true"),t.dataset.hoverListenerAttached||(e(t,"mouseenter",(()=>{n()||s.isInteracting||s.isActive||s.expand()})),e(t,"mouseleave",(()=>{n()||s.isInteracting||s.isActive||s.collapse()})),t.dataset.hoverListenerAttached="true")})),a(),l(),s.forEach((e=>e.classList.add("js-stoerer-ready")))}let d;c(),window.addEventListener("resize",(()=>{clearTimeout(d),d=setTimeout(c,250)})),e(document,"click",(function(e){const t=e.target.closest(".ce--stoerer.is-expandable");i.forEach(((e,s)=>{s!==t&&(e.isExpanded||e.isActive)&&(e.collapse(),e.deactivate())}))})),document.body.addEventListener("stoererAdded",(function(e){console.log("Event stoererAdded empfangen."),requestAnimationFrame((()=>{setTimeout((()=>{c(),setTimeout((()=>{a(),l()}),50)}),100)}))}))}))})();